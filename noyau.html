<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Kernel &mdash; bits v0.5 documentation</title>
    <link rel="stylesheet" href="static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="bits v0.5 documentation" href="index.html" />
    <link rel="next" title="kvm" href="kvm.html" />
    <link rel="prev" title="Partitioning a disk" href="partition.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="kvm.html" title="kvm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="partition.html" title="Partitioning a disk"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">bits v0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Kernel</a><ul>
<li><a class="reference external" href="#install-sources-or-just-headers">Install sources or just headers</a></li>
<li><a class="reference external" href="#compiler-un-nouveau-noyau-sous-debian">Compiler un nouveau noyau sous debian</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="partition.html"
                                  title="previous chapter">Partitioning a disk</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="kvm.html"
                                  title="next chapter">kvm</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="sources/noyau.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="kernel">
<h1>Kernel<a class="headerlink" href="#kernel" title="Permalink to this headline">¶</a></h1>
<p>Cette page est censé répondre</p>
<ul class="simple">
<li>Pour l&#8217;install de VMWare ou Ndiswrapper, recompiler le noyau ou
juste installer les en-têtes?</li>
<li>Quid de la pollution de /usr/lib/modules par les nouveaux noyaux?</li>
<li>De l&#8217;upgrade d&#8217;un noyau à un autre (automatique ou locked)?</li>
</ul>
<div class="section" id="install-sources-or-just-headers">
<h2>Install sources or just headers<a class="headerlink" href="#install-sources-or-just-headers" title="Permalink to this headline">¶</a></h2>
<p>Installer les sources du noyaux ou juste les fichiers d&#8217;en-têtes (headers)?</p>
<p>En résumé</p>
<div class="highlight-python"><pre>sudo apt-get install linux-source-`uname -r`
cd vmware-directory &amp;&amp; sudo vmware-install</pre>
</div>
<p>Maintenant, l&#8217;explication: dans plusieurs cas (install de Vmware, de
drivers Nvidia, ou de Ndiswrapper, driver de webcam), les sources du
noyaux sont nécessaires car elle contiennent des infos qui vont
permettre d&#8217;optimiser le driver/module.</p>
<p>Seulement, si l&#8217;on utilise tranquillement le noyau patché d&#8217;Ubuntu
2.6.10-5-386, on va chercher a installer le paquet des sources
correspondante... Que l&#8217;on ne va pas trouver. On va trouver seulement
les sources officielles (linux-source-2.6.10) et les patchs
(linux-patch-ubuntu-2.6.10) pas de paquets
linux-source-2.6.10-5-386. Et si l&#8217;on installe juste les sources
officielles, le module créé refusera de se charger ou vmware refusera
de s&#8217;installer vu qu&#8217;il n&#8217;a pas été compilé pour ce noyau précis (le
suffixe -5-386 fait toute la différence). On se retrouve donc a
compiler le noyau 2.6.10 et à utiliser ce noyau, pour pouvoir enfin
charger ce module.</p>
<p>Ce n&#8217;est pas super productif de compiler un nouveau noyau &#8220;pur&#8221; pour
des drivers alors qu&#8217;en plus Ubuntu s&#8217;est décarcassé pour intégrer les
meilleurs patchs.</p>
<p>La solution, c&#8217;est d&#8217;installer juste les fichiers d&#8217;entête (headers)
qui contiennent effectivement les infos nécessaires. Ce paquet colle
parfaitement a la version du noyau installé et donc les modules créés
se chargeront sans problèmes.</p>
</div>
<div class="section" id="compiler-un-nouveau-noyau-sous-debian">
<h2>Compiler un nouveau noyau sous debian<a class="headerlink" href="#compiler-un-nouveau-noyau-sous-debian" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">D&#8217;abord, installer des paquets supplémentaires pour configurer le
noyau l&#8217;interface gtk:</p>
<div class="highlight-python"><pre>sudo aptitude install libglib2.0-dev libgtk2.0-dev libglade2-dev</pre>
</div>
</li>
<li><p class="first">J&#8217;installe le paquet des sources du noyau 2.6.10, ainsi que le
paquet de la commande make-kpkg:</p>
<div class="highlight-python"><pre>sudo aptitude install source-linux-2.6.10 kernel-package</pre>
</div>
</li>
<li><p class="first">Création d&#8217;un nouveau groupe src, ajout de jd, appartenance des
sources du noyau au groupe src:</p>
<div class="highlight-python"><pre>sudo addgrp src
sudo chgrp -R src /usr/src
sudo adduser jd src
newgrp src</pre>
</div>
</li>
<li><p class="first">Décompression des sources, création du lien pointant vers le noyau
&#8220;de travail&#8221;:</p>
<div class="highlight-python"><pre>cd /usr/src
tar xjf linux-source-2.6.10
ln -s kernel-linux linux
cd linux</pre>
</div>
</li>
<li><p class="first">Configuration du noyau en partant de la configuration du noyau actuelle</p>
<div class="highlight-python"><pre>cp /boot/config-2.6.10-5-386 .config
sudo make-kpkg --initrd --revision=mykernel01 kernel_image
sudo dpkg -i ../kernel*</pre>
</div>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="kvm.html" title="kvm"
             >next</a> |</li>
        <li class="right" >
          <a href="partition.html" title="Partitioning a disk"
             >previous</a> |</li>
        <li><a href="index.html">bits v0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, jdb.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>